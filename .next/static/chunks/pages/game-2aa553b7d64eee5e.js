(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{134:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return i(3308)}])},3308:function(e,t,i){"use strict";i.r(t);var s=i(5893),a=i(7294),n=i(9008),h=i.n(n);function randomRange(e,t){return Math.random()*(t-e)+e}function distance(e,t,i,s){return Math.sqrt((i-e)**2+(s-t)**2)}let Particle=class Particle{update(e){this.x+=this.vx*e,this.y+=this.vy*e,this.life-=e}draw(e){this.life<=0||(e.globalAlpha=Math.max(this.life/this.maxLife,0),e.fillStyle=this.color,e.beginPath(),e.arc(this.x,this.y,this.size,0,2*Math.PI),e.fill(),e.globalAlpha=1)}constructor(e,t,i){this.x=e,this.y=t,this.vx=randomRange(-150,150),this.vy=randomRange(-150,150),this.maxLife=randomRange(.8,1.8),this.life=this.maxLife,this.size=randomRange(2,6),this.color=i}};let ParticleSystem=class ParticleSystem{addExplosion(e,t,i,s){for(let a=0;a<s;a++)this.particles.push(new Particle(e,t,i))}update(e){for(let t=this.particles.length-1;t>=0;t--)this.particles[t].update(e),this.particles[t].life<=0&&this.particles.splice(t,1)}draw(e){this.particles.forEach(t=>t.draw(e))}constructor(){this.particles=[]}};let ParallaxLayer=class ParallaxLayer{update(e){this.offsetX+=50*e*this.speedMultiplier,this.offsetX>window.innerWidth&&(this.offsetX=0)}draw(e){if(this.image&&this.loaded){let t=e.createPattern(this.image,"repeat");t&&(e.save(),e.translate(-this.offsetX,0),e.fillStyle=t,e.fillRect(0,0,window.innerWidth+this.offsetX,window.innerHeight),e.restore())}else e.fillStyle=this.color,e.fillRect(0,0,window.innerWidth,window.innerHeight)}constructor(e,t){this.x=0,this.y=0,this.speedMultiplier=t,this.offsetX=0,e.startsWith("http")||e.endsWith(".png")||e.endsWith(".jpg")?(this.image=new Image,this.image.src=e,this.loaded=!1,this.image.onload=()=>{this.loaded=!0},this.color=""):(this.image=null,this.loaded=!0,this.color=e)}};let AudioManager=class AudioManager{playSound(e){console.log("Playing sound: ".concat(e))}};let SnakeSegment=class SnakeSegment{update(e,t){this.x=e,this.y=t}draw(e){e.fillStyle=this.color,e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI),e.fill()}constructor(e,t,i,s){this.x=e,this.y=t,this.radius=i,this.color=s}};let Snake=class Snake{get x(){return this.segments[0].x}get y(){return this.segments[0].y}update(e){for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];let a=this.desiredAngle-this.angle;Math.abs(a)>.01&&(this.angle+=Math.sign(a)*Math.min(Math.abs(a),this.turnSpeed*e));let n=this.segments[0],h=n.x+Math.cos(this.angle)*this.speed*e,l=n.y+Math.sin(this.angle)*this.speed*e;h=Math.max(this.headRadius,Math.min(window.innerWidth-this.headRadius,h)),l=Math.max(this.headRadius,Math.min(window.innerHeight-this.headRadius,l)),this.segments.unshift(new SnakeSegment(h,l,this.headRadius,this.color)),this.segments.pop()}grow(e){for(let t=0;t<e;t++){let e=this.segments[this.segments.length-1];this.segments.push(new SnakeSegment(e.x,e.y,this.headRadius,this.color))}this.score+=10*e}setDesiredAngle(e){this.desiredAngle=e}draw(e){for(let t of this.segments)t.draw(e)}collidesWith(e,t,i){let s=this.segments[0];return distance(s.x,s.y,e,t)<s.radius+i}checkSelfCollision(){let e=this.segments[0];for(let t=4;t<this.segments.length;t++)if(distance(e.x,e.y,this.segments[t].x,this.segments[t].y)<e.radius+this.segments[t].radius)return!0;return!1}constructor(e,t,i){this.headRadius=12,this.color=i,this.segments=[new SnakeSegment(e,t,this.headRadius,this.color)],this.speed=150,this.angle=0,this.desiredAngle=0,this.turnSpeed=Math.PI,this.score=0,this.alive=!0}};let PlayerSnake=class PlayerSnake extends Snake{constructor(e,t,i){super(e,t,i),this.speed=180,this.turnSpeed=1.2*Math.PI}};let EnemySnake=class EnemySnake extends Snake{update(e,t){this.changeTimer-=e;let i=distance(this.x,this.y,t.x,t.y);i<150&&t.score>this.score?(this.state="flee",this.desiredAngle=Math.atan2(this.y-t.y,this.x-t.x)):i<300&&t.score>this.score?(this.state="chase",this.desiredAngle=Math.atan2(t.y-this.y,t.x-this.x)):(this.state="wander",this.changeTimer<=0&&(this.desiredAngle=randomRange(0,2*Math.PI),this.changeTimer=randomRange(2,5))),super.update(e)}constructor(e,t,i){super(e,t,i),this.speed=randomRange(100,160),this.angle=randomRange(0,2*Math.PI),this.desiredAngle=this.angle,this.changeTimer=randomRange(2,5),this.state="wander"}};let Star=class Star{update(e){}draw(e){e.fillStyle=this.color,e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI),e.fill()}constructor(e,t,i=6,s="#ffcc00"){this.x=e,this.y=t,this.radius=i,this.color=s}};t.default=()=>{let e=(0,a.useRef)(null),[t,i]=(0,a.useState)(0),[n,l]=(0,a.useState)(1),[r,o]=(0,a.useState)(3),[d,c]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let t=e.current;if(!t)return;let s=t.getContext("2d");if(!s)return;let setCanvasSize=()=>{t.width=window.innerWidth,t.height=window.innerHeight};setCanvasSize(),window.addEventListener("resize",setCanvasSize);let a=performance.now(),h=0,l=0,o=0,f=new PlayerSnake(t.width/2,t.height/2,"#00ffcc"),g=[];for(let e=0;e<5;e++)g.push(new EnemySnake(randomRange(50,t.width-50),randomRange(50,t.height-50),"#ff6699"));let u=[];for(let e=0;e<30;e++)u.push(new Star(randomRange(20,t.width-20),randomRange(20,t.height-20)));let m=new ParticleSystem;new AudioManager;let w=new ParallaxLayer("/images/bg_layer.png",.2),p=new ParallaxLayer("/images/mg_layer.png",.5);return t.addEventListener("mousemove",e=>{let i=t.getBoundingClientRect(),s=e.clientX-i.left,a=e.clientY-i.top,n=f.segments[0],h=Math.atan2(a-n.y,s-n.x);f.setDesiredAngle(h)}),requestAnimationFrame(function gameLoop(e){var x,y,S,R,M,v;if(!s)return;let P=(e-a)/1e3;(a=e,o+=P,l++,o>=1&&(h=l/o,l=0,o=0),s.clearRect(0,0,t.width,t.height),function(e,t,i,s){e.clearRect(0,0,t,i),e.fillStyle="#000",e.fillRect(0,0,t,i);for(let a=0;a<250;a++){let n=(Math.sin(s/1500+a)+1)/2*t,h=(Math.cos(s/1500+a)+1)/2*i;e.fillStyle="#222",e.fillRect(n,h,2,2)}}(s,t.width,t.height,e),w.update(P),p.update(P),w.draw(s),p.draw(s),f.update(P),f.draw(s),u.forEach(e=>{e.draw(s),f.collidesWith(e.x,e.y,e.radius)&&(f.grow(1),i(f.score),m.addExplosion(e.x,e.y,"#ffcc00",15),e.x=randomRange(20,t.width-20),e.y=randomRange(20,t.height-20))}),g.forEach(e=>{e.update(P,f),e.draw(s),distance(f.x,f.y,e.x,e.y)<f.headRadius+e.headRadius&&(f.score>e.score?(f.grow(Math.floor(e.segments.length/3)),m.addExplosion(e.x,e.y,"#ff6699",30),i(f.score),e.segments=[new SnakeSegment(randomRange(50,t.width-50),randomRange(50,t.height-50),e.headRadius,e.color)]):(m.addExplosion(f.x,f.y,"#ffff00",30),c(!0)))}),m.update(P),m.draw(s),x=f.score,s.fillStyle="#fff",s.font="24px Arial",s.fillText("Score: ".concat(x),20,40),s.fillText("Lives: ".concat(r),20,70),s.fillText("Level: ".concat(n),20,100),function(e,t){e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(window.innerWidth-150-20,20,150,150),e.fillStyle="#fff",e.font="12px Arial",e.fillText("MiniMap",window.innerWidth-150,40),e.fillStyle="#00ffff";let i=window.innerWidth-150+t.x/window.innerWidth*150,s=20+t.y/window.innerHeight*150;e.fillRect(i,s,5,5)}(s,f),y=h,S=g.length+u.length+m.particles.length,s.fillStyle="rgba(0,0,0,0.6)",s.fillRect(10,10,170,60),s.fillStyle="#0f0",s.font="14px Courier New",s.fillText("FPS: ".concat(y.toFixed(1)),20,30),s.fillText("Objects: ".concat(S),20,50),d)?(R=t.width,M=t.height,v=f.score,s.fillStyle="rgba(0,0,0,0.85)",s.fillRect(0,0,R,M),s.fillStyle="#ff0000",s.font="48px Arial",s.fillText("GAME OVER",R/2-150,M/2-20),s.fillStyle="#fff",s.font="28px Arial",s.fillText("Final Score: ".concat(v),R/2-100,M/2+30)):requestAnimationFrame(gameLoop)}),()=>{window.removeEventListener("resize",setCanvasSize),t.removeEventListener("mousemove",()=>{})}},[d]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(h(),{children:[(0,s.jsx)("title",{children:"Ultimate Cosmic Snake: God Edition"}),(0,s.jsx)("meta",{name:"description",content:"究極のスリザリオ風ゲーム。マウス操作で蛇を操り、星を集め、敵AIを倒して成長せよ！"})]}),(0,s.jsxs)("div",{style:{background:"#000",color:"#fff",textAlign:"center"},children:[(0,s.jsx)("h1",{style:{padding:"20px 0"},children:"Ultimate Cosmic Snake: God Edition"}),(0,s.jsx)("p",{children:"マウスを動かして蛇を操作。星を拾い、敵を食べて巨大化せよ！"}),(0,s.jsx)("canvas",{ref:e,style:{border:"2px solid #fff",marginTop:"20px"}})]})]})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=134)}),_N_E=e.O()}]);