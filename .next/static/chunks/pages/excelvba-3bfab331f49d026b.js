(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[157],{5853:function(n,s,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/excelvba",function(){return e(6231)}])},6231:function(n,s,e){"use strict";e.r(s),e.d(s,{default:function(){return ExcelVBA}});var t=e(5893);e(7294);var i=e(9008),r=e.n(i),l=e(4298),o=e.n(l);function ExcelVBA(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r(),{children:[(0,t.jsx)("title",{children:"ExcelVBA - FizzBuzz & Prime Sample"}),(0,t.jsx)("meta",{name:"description",content:"A Next.js page showing a complete sample of VBA for FizzBuzz & prime checking with partial re-run from row B9."}),(0,t.jsx)("meta",{charSet:"UTF-8"})]}),(0,t.jsxs)("div",{style:{maxWidth:"900px",margin:"0 auto",padding:"20px"},children:[(0,t.jsx)("h1",{children:"Excel VBA 実装例"}),(0,t.jsxs)("p",{children:["以下は「シート『演習』のA列を見て、3/5/15の倍数チェック、素数チェック、累計カウンタ更新を行う」VBAコード例です。",(0,t.jsx)("br",{}),"ボタンイベントを3つ用意し、",(0,t.jsx)("strong",{children:"2行目から実行"}),"、",(0,t.jsx)("strong",{children:"指定行から実行"}),"、",(0,t.jsx)("strong",{children:"素数判定"})," を含む形でまとめています。"]}),(0,t.jsx)("h2",{children:"前提条件"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"「演習」シートを想定（A列, B列, C列, D/E/F列 など）。"}),(0,t.jsx)("li",{children:'A列が空欄または "end" と出てきたら処理終了。'}),(0,t.jsx)("li",{children:"途中実行開始行は B9 セルの値を使う。"}),(0,t.jsx)("li",{children:"数値以外は FizzBuzz 判定しない。素数判定もしない。"}),(0,t.jsx)("li",{children:"D/E/F 列に Fizz, Buzz, FizzBuzz の出現累計を随時記入。"})]}),(0,t.jsx)("hr",{style:{margin:"20px 0"}}),(0,t.jsx)("h2",{children:"標準モジュール (Module1など) の VBA コード"}),(0,t.jsx)("pre",{style:{background:"#222",color:"#ccc",padding:"1rem",borderRadius:"8px",overflowX:"auto"},children:'Option Explicit\n\n\'▼▼▼ まずは素数判定用の関数 ▼▼▼\nFunction IsPrime(ByVal num As Variant) As Boolean\n    Dim i As Long\n    Dim n As Long\n    \n    \' 数値でない場合や 2 未満の場合は素数ではない\n    If Not IsNumeric(num) Then\n        IsPrime = False\n        Exit Function\n    End If\n    \n    n = CLng(num)\n    If n < 2 Then\n        IsPrime = False\n        Exit Function\n    End If\n    \n    \' 2～Sqrt(n) で割り切れるかどうか\n    For i = 2 To CLng(Sqr(n))\n        If (n Mod i) = 0 Then\n            IsPrime = False\n            Exit Function\n        End If\n    Next i\n    \n    IsPrime = True\nEnd Function\n\n\'▼▼▼ A列の値を判定して B/C/D/E/F列を更新する共通処理 ▼▼▼\nSub FizzBuzzAndPrimeProcess(ByVal startRow As Long)\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets("演習")\n    \n    Dim rowCnt As Long\n    Dim valA As Variant\n    \n    \' 累計カウンタ\n    Dim cntFizz     As Long\n    Dim cntBuzz     As Long\n    Dim cntFizzBuzz As Long\n    \n    \' 事前に「本当にこの行から実行してよいか」確認（ユーザに優しい実装）\n    If MsgBox("行番号 " & startRow & " からFizzBuzz＆素数判定を実行します。よろしいですか？", _\n              vbOKCancel Or vbQuestion) = vbCancel Then\n        Exit Sub\n    End If\n    \n    \' 最終行を取得\n    Dim lastRow As Long\n    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row\n    \n    \' 開始行が最終行を超えていないかチェック\n    If lastRow < startRow Then\n        MsgBox "開始行(" & startRow & ")が最終データ行(" & lastRow & ")より大きいため、処理不要です。", vbExclamation\n        Exit Sub\n    End If\n    \n    \' 該当開始行～最終行の D/E/F 列をクリア (累計を取り直すため)\n    ws.Range(ws.Cells(startRow, "D"), ws.Cells(lastRow, "F")).ClearContents\n    \n    \' メインループ\n    For rowCnt = startRow To lastRow\n        \n        valA = ws.Cells(rowCnt, "A").Value\n        \n        \' 空白 or "end" ならループ終了\n        If (Trim(valA & "") = "") Or (LCase(valA & "") = "end") Then\n            Exit For\n        End If\n        \n        \' 素数判定 → C列に"●"\n        If IsPrime(valA) Then\n            ws.Cells(rowCnt, "C").Value = "●"\n        Else\n            ws.Cells(rowCnt, "C").ClearContents\n        End If\n        \n        \' FizzBuzz判定 → B列\n        Dim numA As Long\n        Dim strResult As String\n        \n        If IsNumeric(valA) Then\n            numA = CLng(valA)\n            \n            If numA Mod 15 = 0 Then\n                strResult = "FizzBuzz"\n            ElseIf numA Mod 3 = 0 Then\n                strResult = "Fizz"\n            ElseIf numA Mod 5 = 0 Then\n                strResult = "Buzz"\n            Else\n                strResult = ""\n            End If\n        Else\n            strResult = ""\n        End If\n        \n        ws.Cells(rowCnt, "B").Value = strResult\n        \n        \' 累計カウンタを更新\n        Select Case strResult\n            Case "FizzBuzz"\n                cntFizzBuzz = cntFizzBuzz + 1\n            Case "Fizz"\n                cntFizz = cntFizz + 1\n            Case "Buzz"\n                cntBuzz = cntBuzz + 1\n        End Select\n        \n        \' D/E/F列に累計を反映\n        ws.Cells(rowCnt, "D").Value = cntFizz\n        ws.Cells(rowCnt, "E").Value = cntBuzz\n        ws.Cells(rowCnt, "F").Value = cntFizzBuzz\n    Next rowCnt\n    \n    MsgBox "FizzBuzz & 素数判定が完了しました。", vbInformation\nEnd Sub\n\n\'▼▼▼ (1)～(3) の 実行ボタン用のマクロ ▼▼▼\nPublic Sub BtnExec_Click()\n    \' シート「演習」の 2行目から処理を開始\n    FizzBuzzAndPrimeProcess 2\nEnd Sub\n\n\'▼▼▼ (2) 「行目から実行」ボタン用のマクロ ▼▼▼\nPublic Sub BtnExecFromRow_Click()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets("演習")\n    \n    Dim startRow As Long\n    \n    \' B9セルを読み取り (数値でない場合は2行目にフォールバック)\n    If IsNumeric(ws.Range("B9").Value) Then\n        startRow = CLng(ws.Range("B9").Value)\n    Else\n        startRow = 2\n        MsgBox "B9の値が数値でないため、2行目から実行します。", vbExclamation\n    End If\n    \n    \' 2未満なら2行目に補正\n    If startRow < 2 Then\n        startRow = 2\n        MsgBox "B9の値が2未満なので、2行目から実行します。", vbExclamation\n    End If\n    \n    \' 実行\n    FizzBuzzAndPrimeProcess startRow\nEnd Sub\n'}),(0,t.jsxs)("p",{children:["このコードを「標準モジュール(Module1やSampleなど)」に貼り付けて、",(0,t.jsx)("br",{}),"①",(0,t.jsx)("code",{children:"BtnExec_Click"}),"ボタン → 2行目から実行",(0,t.jsx)("br",{}),"②",(0,t.jsx)("code",{children:"BtnExecFromRow_Click"}),"ボタン → B9セルの行から実行",(0,t.jsx)("br",{}),"などの形で関連付ければ動作します。",(0,t.jsx)("br",{}),"実行前に確認メッセージを出したり、処理完了後にMsgBoxで知らせるため、ユーザーフレンドリーな設計になっています。"]}),(0,t.jsx)("hr",{style:{margin:"20px 0"}}),(0,t.jsx)("h2",{children:"ポイント"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"A列が数値以外の場合はFizzBuzz・素数判定をスキップしています。"}),(0,t.jsx)("li",{children:"D/E/F列を開始行～最終行分だけクリアし、0から再集計しています。"}),(0,t.jsx)("li",{children:"既存D/E/Fを活かして途中から継続計算する場合は、コードを多少アレンジしてください。"}),(0,t.jsxs)("li",{children:["シート「演習」以外の名前を使うなら、",(0,t.jsx)("code",{children:'Worksheets("演習")'})," を書き換えてください。"]})]}),(0,t.jsxs)("p",{style:{marginTop:"2rem"},children:["以上のVBAコードで、Fizz/Buzz/FizzBuzzと素数を同時にチェックしつつ累計を記録できます。",(0,t.jsx)("br",{}),"適宜カスタマイズしてご利用ください。"]})]}),(0,t.jsx)(o(),{src:"/js/galaxyArtSim.js",strategy:"afterInteractive",onLoad:()=>{console.log("galaxyArtSim loaded on ExcelVBA page")}})]})}},4298:function(n,s,e){n.exports=e(5354)}},function(n){n.O(0,[774,888,179],function(){return n(n.s=5853)}),_N_E=n.O()}]);