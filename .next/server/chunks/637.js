exports.id=637,exports.ids=[637],exports.modules={6877:(e,r,t)=>{"use strict";t.d(r,{Z:()=>ChatGPTInterface});var n=t(997),a=t(6689);function MessageBubble({role:e,content:r}){return(0,n.jsxs)("div",{className:`message-bubble ${e}`,style:{margin:"0.4rem 0"},children:[(0,n.jsxs)("strong",{style:{textTransform:"capitalize"},children:[e,":"]})," ",r]})}function ChatGPTInterface({isGlass:e=!1,maxTokens:r=2e3,presencePenalty:t=0,frequencyPenalty:o=0,temperature:s=.7,model:l="gpt-3.5-turbo"}){let[i,d]=(0,a.useState)([]),[c,p]=(0,a.useState)(""),[f,u]=(0,a.useState)(!1),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[i]);let handleFileUpload=e=>{if(!e||!e[0])return;let r=e[0],t={role:"user",content:`File uploaded: ${r.name} (size=${r.size} bytes)`};d(e=>[...e,t])},handleSend=async()=>{if(!c.trim())return;let e={role:"user",content:c.trim()},n=[...i,e];d(n),p(""),u(!0);try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:l,messages:n,temperature:s,max_tokens:r,presence_penalty:t,frequency_penalty:o})}),a=await e.json();if(!e.ok||a?.error){console.error("[ChatGPTInterface] /api/chat error:",a?.error||a),d(e=>[...e,{role:"assistant",content:"(APIエラー: "+JSON.stringify(a?.error||a)+")"}]),u(!1);return}let i=a?.choices?.[0]?.message?.content||"(no answer from AI)",c="",p=0,f=setInterval(()=>{p<i.length?(c+=i.charAt(p++),d(e=>{let r=e[e.length-1];return r&&"assistant"===r.role?[...e.slice(0,-1),{role:"assistant",content:c}]:[...e,{role:"assistant",content:c}]})):(clearInterval(f),u(!1))},20)}catch(e){console.error("Error calling /api/chat:",e),u(!1),d(e=>[...e,{role:"assistant",content:"(通信エラーが発生しました)"}])}},h={margin:"0 auto",width:"90%",maxWidth:"600px",height:"70vh",display:"flex",flexDirection:"column",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.3)",boxShadow:"0 0 10px rgba(0,0,0,0.5)",color:"#fff",position:"relative",zIndex:10,overflow:"hidden",...e?{background:"transparent"}:{background:"rgba(0,0,0,0.4)"}};return(0,n.jsxs)("div",{style:h,children:[(0,n.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"1rem"},children:[i.map((e,r)=>n.jsx(MessageBubble,{role:e.role,content:e.content},r)),n.jsx("div",{ref:g})]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",padding:"0.75rem",borderTop:"1px solid rgba(255,255,255,0.3)",background:e?"transparent":"rgba(0,0,0,0.6)"},children:[n.jsx("div",{style:{marginBottom:"0.5rem"},children:n.jsx("input",{type:"file",onChange:e=>handleFileUpload(e.target.files),style:{color:"#fff",background:"transparent"}})}),n.jsx("textarea",{style:{resize:"none",border:e?"1px solid rgba(255,255,255,0.4)":"1px solid #444",borderRadius:"4px",padding:"0.75rem",fontSize:"0.95rem",fontFamily:"sans-serif",background:e?"transparent":"#222",color:"#fff",width:"100%",marginBottom:"0.5rem"},placeholder:"Type your message...",value:c,onChange:e=>p(e.target.value),disabled:f}),n.jsx("button",{style:{background:"#31a37d",color:"#fff",border:"none",borderRadius:"4px",padding:"0.6rem 1.2rem",fontSize:"1rem",cursor:"pointer",alignSelf:"flex-end"},onClick:handleSend,disabled:f||!c.trim(),children:f?"...":"Send"})]})]})}},4298:(e,r,t)=>{e.exports=t(5354)}};