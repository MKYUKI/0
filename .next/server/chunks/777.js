exports.id=777,exports.ids=[777],exports.modules={6877:(e,r,t)=>{"use strict";t.d(r,{Z:()=>ChatGPTInterface});var n=t(997),a=t(6689);function MessageBubble({role:e,content:r}){return(0,n.jsxs)("div",{className:`message-bubble ${e}`,style:{margin:"0.4rem 0"},children:[(0,n.jsxs)("strong",{style:{textTransform:"capitalize"},children:[e,":"]})," ",r]})}function ChatGPTInterface({isGlass:e=!1,maxTokens:r=2e3,presencePenalty:t=0,frequencyPenalty:s=0,temperature:o=.7,model:i="gpt-3.5-turbo"}){let[l,c]=(0,a.useState)([]),[d,p]=(0,a.useState)(""),[h,x]=(0,a.useState)(!1),u=(0,a.useRef)(null);(0,a.useEffect)(()=>{u.current?.scrollIntoView({behavior:"smooth"})},[l]);let handleFileUpload=e=>{if(!e||!e[0])return;let r=e[0],t={role:"user",content:`File uploaded: ${r.name} (size=${r.size} bytes)`};c(e=>[...e,t])},handleSend=async()=>{if(!d.trim())return;let e={role:"user",content:d.trim()},n=[...l,e];c(n),p(""),x(!0);try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:i,messages:n,temperature:o,max_tokens:r,presence_penalty:t,frequency_penalty:s})}),a=await e.json();if(!e.ok||a?.error){console.error("[ChatGPTInterface] /api/chat error:",a?.error||a),c(e=>[...e,{role:"assistant",content:"(APIエラー: "+JSON.stringify(a?.error||a)+")"}]),x(!1);return}let l=a?.choices?.[0]?.message?.content||"(no answer from AI)",d="",p=0,h=setInterval(()=>{p<l.length?(d+=l.charAt(p++),c(e=>{let r=e[e.length-1];return r&&"assistant"===r.role?[...e.slice(0,-1),{role:"assistant",content:d}]:[...e,{role:"assistant",content:d}]})):(clearInterval(h),x(!1))},20)}catch(e){console.error("Error calling /api/chat:",e),x(!1),c(e=>[...e,{role:"assistant",content:"(通信エラーが発生しました)"}])}},f={margin:"0 auto",width:"90%",maxWidth:"600px",height:"70vh",display:"flex",flexDirection:"column",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.3)",boxShadow:"0 0 10px rgba(0,0,0,0.5)",color:"#fff",position:"relative",zIndex:10,overflow:"hidden",...e?{background:"transparent"}:{background:"rgba(0,0,0,0.4)"}};return(0,n.jsxs)("div",{style:f,children:[(0,n.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"1rem"},children:[l.map((e,r)=>n.jsx(MessageBubble,{role:e.role,content:e.content},r)),n.jsx("div",{ref:u})]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",padding:"0.75rem",borderTop:"1px solid rgba(255,255,255,0.3)",background:e?"transparent":"rgba(0,0,0,0.6)"},children:[n.jsx("div",{style:{marginBottom:"0.5rem"},children:n.jsx("input",{type:"file",onChange:e=>handleFileUpload(e.target.files),style:{color:"#fff",background:"transparent"}})}),n.jsx("textarea",{style:{resize:"none",border:e?"1px solid rgba(255,255,255,0.4)":"1px solid #444",borderRadius:"4px",padding:"0.75rem",fontSize:"0.95rem",fontFamily:"sans-serif",background:e?"transparent":"#222",color:"#fff",width:"100%",marginBottom:"0.5rem"},placeholder:"Type your message...",value:d,onChange:e=>p(e.target.value),disabled:h}),n.jsx("button",{style:{background:"#31a37d",color:"#fff",border:"none",borderRadius:"4px",padding:"0.6rem 1.2rem",fontSize:"1rem",cursor:"pointer",alignSelf:"flex-end"},onClick:handleSend,disabled:h||!d.trim(),children:h?"...":"Send"})]})]})}},9777:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>MyApp});var n=t(997),a=t(6689),s=t.n(a),o=t(968),i=t.n(o),l=t(1664),c=t.n(l),d=t(1163);t(6764);var p=t(6877);let components_SearchBar=()=>{let[e,r]=(0,a.useState)(""),[t,s]=(0,a.useState)(""),handleSearch=async()=>{if(e.trim())try{let r=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:e}],temperature:.7,max_tokens:150,presence_penalty:0,frequency_penalty:0})}),t=await r.json(),n=t?.choices?.[0]?.message?.content||"No answer";s(n)}catch(e){console.error("Search error:",e),s("Error occurred")}};return(0,n.jsxs)("div",{style:{position:"relative"},children:[n.jsx("input",{type:"text",placeholder:"Search...",value:e,onChange:e=>r(e.target.value),onKeyDown:e=>{"Enter"===e.key&&handleSearch()},style:{padding:"6px 10px",borderRadius:"4px",border:"1px solid #ccc"}}),n.jsx("button",{onClick:handleSearch,style:{marginLeft:"8px",padding:"6px 10px",borderRadius:"4px",border:"none",backgroundColor:"#2187ff",color:"#fff",cursor:"pointer"},children:"Search"}),t&&n.jsx("div",{style:{position:"absolute",top:"calc(100% + 8px)",right:0,backgroundColor:"#fff",color:"#000",padding:"8px",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",zIndex:100,maxWidth:"300px"},children:t})]})};function NavBar(){return(0,n.jsxs)("header",{className:"navbar",style:{backgroundColor:"#000",color:"#fff",padding:"10px 20px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsxs)("div",{className:"nav-left",children:[n.jsx(c(),{href:"/",className:"nav-link",style:{marginRight:"16px"},children:"Home"}),n.jsx(c(),{href:"/aichat",className:"nav-link",style:{marginRight:"16px"},children:"AI Chat"}),n.jsx(c(),{href:"/art",className:"nav-link",style:{marginRight:"16px"},children:"Art"}),n.jsx(c(),{href:"/excelvba",className:"nav-link",style:{marginRight:"16px"},children:"ExcelVBA"}),n.jsx(c(),{href:"/contact",className:"nav-link",style:{marginRight:"16px"},children:"Contact"})]}),n.jsx("div",{className:"nav-right",children:n.jsx(components_SearchBar,{})})]})}let ErrorBoundary=class ErrorBoundary extends s().Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,r){console.error("[ErrorBoundary] Caught error:",e,r)}render(){return this.state.hasError?(0,n.jsxs)("div",{style:{color:"red",textAlign:"center",marginTop:"50px"},children:[n.jsx("h1",{children:"Something went wrong."}),n.jsx("p",{children:"Reload or contact support if the issue persists."})]}):this.props.children}};function MyApp({Component:e,pageProps:r}){let t=(0,d.useRouter)();return(0,a.useEffect)(()=>{console.log("[MyApp] mounted on client side.")},[]),(0,n.jsxs)(ErrorBoundary,{children:[(0,n.jsxs)(i(),{children:[n.jsx("title",{children:"GPT-3.5 App with Fallback"}),n.jsx("meta",{name:"description",content:"Next.js + GPT-3.5, with fallback for insufficient_quota error."}),n.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"})]}),(0,n.jsxs)("div",{id:"app-wrapper",style:{minHeight:"100vh",background:"#000",color:"#fff"},children:[n.jsx(NavBar,{}),n.jsx("main",{id:"main-content",style:{padding:"20px"},children:n.jsx(e,{...r})}),n.jsx("footer",{id:"chat-footer",style:{marginTop:"20px",padding:"10px"},children:"/"!==t.pathname&&"/art"!==t.pathname&&"/aichat"!==t.pathname&&"/contact"!==t.pathname&&"/books"!==t.pathname&&"/excelvba"!==t.pathname&&(0,n.jsxs)("div",{style:{borderTop:"1px solid #666",paddingTop:"8px"},children:[n.jsx("h3",{children:"Global GPT Chat"}),n.jsx(p.Z,{isGlass:!1,maxTokens:1200,temperature:.7,presencePenalty:0,frequencyPenalty:0})]})})]})]})}},6764:()=>{}};